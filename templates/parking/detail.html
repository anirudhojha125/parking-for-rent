{% extends "base.html" %}

{% block title %}{{ space.title }} - Smart Park System{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <h2>{{ space.title }}</h2>
                <p class="text-muted">Listed by {{ space.owner.username }}</p>
                
                {% if space.images and space.images|length > 0 %}
                    <!-- Placeholder for image gallery -->
                    <div class="bg-light mb-3" style="height: 300px; display: flex; align-items: center; justify-content: center;">
                        <span class="text-muted">Parking Space Images</span>
                    </div>
                {% else %}
                    <div class="bg-light mb-3" style="height: 300px; display: flex; align-items: center; justify-content: center;">
                        <span class="text-muted">No Images Available</span>
                    </div>
                {% endif %}
                
                <h5>Description</h5>
                <p>{{ space.description or 'No description provided.' }}</p>
                
                <h5>Location</h5>
                <p>{{ space.address }}</p>
                {% if space.latitude and space.longitude %}
                    <p>Coordinates: {{ space.latitude }}, {{ space.longitude }}</p>
                {% endif %}
                
                <h5>Pricing</h5>
                <p>${{ "%.2f"|format(space.price_per_hour) }} per hour</p>
                
                <h5>Availability</h5>
                <p>{{ space.availability_start.strftime('%H:%M') }} - {{ space.availability_end.strftime('%H:%M') }}</p>
                
                <h5>Status</h5>
                <p>
                    {% if space.is_active %}
                        <span class="badge bg-success">Available</span>
                    {% else %}
                        <span class="badge bg-secondary">Not Available</span>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>Book This Space</h5>
            </div>
            <div class="card-body">
                {% if current_user.is_authenticated %}
                    {% if current_user.id == space.owner_id %}
                        <p class="text-info">This is your parking space.</p>
                        <a href="{{ url_for('parking.edit_space', space_id=space.id) }}" class="btn btn-primary w-100 mb-2">Edit Space</a>
                        <form method="POST" action="{{ url_for('parking.delete_space', space_id=space.id) }}" onsubmit="return confirm('Are you sure you want to delete this parking space?')">
                            <button type="submit" class="btn btn-danger w-100">Delete Space</button>
                        </form>
                    {% else %}
                        <a href="{{ url_for('parking.book_space', space_id=space.id) }}" class="btn btn-success w-100">Request Booking</a>
                        <p class="text-muted mt-3"><small>Booking requests must be confirmed by the space owner.</small></p>
                    {% endif %}
                {% else %}
                    <p>Please <a href="{{ url_for('auth.login') }}">log in</a> to book this parking space.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}